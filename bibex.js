javascript:(function(){var title=document.title||'No title found';var url=document.URL;var author='Unknown Author';var pubDate=null;var accessDate=new Date().toISOString().split('T')[0];var metas=document.getElementsByTagName('meta');for(var i=0;i<metas.length;i++){if(metas[i].getAttribute('name')==='author'){author=metas[i].getAttribute('content');author=author.split(',').map(a=>a.trim()).join(' and ');author=author.split(';').map(a=>a.trim()).join(' and ');break;}if(metas[i].getAttribute('name')==='pubdate'||metas[i].getAttribute('property')==='article:published_time'){pubDate=metas[i].getAttribute('content').split('T')[0];}}if(author==='Unknown Author'){var domain=url.split('/')[2];domain=domain.replace('www.','').split('.')[0];author=domain.substring(0,16);}var firstAuthor=author.split(' and ')[0];var lastName=firstAuthor.includes(',')?firstAuthor.split(',')[0]:firstAuthor.split(' ').pop();lastName=lastName.replace(/[^a-zA-Z]/g,'');if(!pubDate){pubDate=accessDate;}var year=pubDate.split('-')[0];var month=pubDate.split('-')[1];var citeKey=lastName+year;var paragraphs=document.getElementsByTagName('p');var abstract='No abstract available';for(var i=0;i<paragraphs.length;i++){if(paragraphs[i].innerText.length>abstract.length){abstract=paragraphs[i].innerText;}}abstract=abstract.replace(/\s+/g,' ').trim();var journal='Unknown Journal';for(var i=0;i<metas.length;i++){if(metas[i].getAttribute('name')==='citation_journal_title'){journal=metas[i].getAttribute('content');break;}}var bibtex=`@misc{${citeKey},\nauthor = {${author}},\ntitle = {${title}},\nhowpublished = {\\url{${url}}},\nmonth = {${month}},\nyear = {${year}},\nnote = {Accessed: ${accessDate}}\n}`;var yaml=`- id: ${citeKey}\n  author:\n    - family: ${lastName}\n      given: ${author.split(' ')[0]}\n  title: "${title}"\n  container-title: "${journal}"\n  issued:\n    year: ${year}\n  URL: ${url}\n  accessed:\n    year: ${accessDate.split('-')[0]}\n    month: ${accessDate.split('-')[1]}\n    day: ${accessDate.split('-')[2]}`;var computedStyle=window.getComputedStyle(document.body);var modal=document.createElement('div');modal.style.position='fixed';modal.style.top='50%';modal.style.left='50%';modal.style.transform='translate(-50%, -50%)';modal.style.backgroundColor='#ffffff';modal.style.color='#000000';modal.style.padding='20px';modal.style.boxShadow='0 0 10px rgba(0,0,0,0.5)';modal.style.zIndex=10000;modal.style.borderRadius='8px';modal.style.maxWidth='600px';modal.style.width='90%';var overlay=document.createElement('div');overlay.style.position='fixed';overlay.style.top='0';overlay.style.left='0';overlay.style.width='100%';overlay.style.height='100%';overlay.style.backgroundColor='rgba(0, 0, 0, 0.5)';overlay.style.zIndex=9999;document.body.appendChild(overlay);var formatToggle=document.createElement('select');formatToggle.style.width='100%';formatToggle.style.marginBottom='10px';formatToggle.style.padding='8px';formatToggle.style.backgroundColor='#ffffff';formatToggle.style.color='#000000';formatToggle.style.border='1px solid #cccccc';var optionYaml=document.createElement('option');optionYaml.value='yaml';optionYaml.text='Pandoc YAML';var optionBibtex=document.createElement('option');optionBibtex.value='bibtex';optionBibtex.text='BibTeX';formatToggle.appendChild(optionYaml);formatToggle.appendChild(optionBibtex);modal.appendChild(formatToggle);var textarea=document.createElement('textarea');textarea.style.width='100%';textarea.style.height='150px';textarea.style.marginBottom='10px';textarea.style.padding='8px';textarea.style.backgroundColor='#ffffff';textarea.style.color='#000000';textarea.style.border='1px solid #cccccc';textarea.value=yaml;modal.appendChild(textarea);formatToggle.onchange=function(){textarea.value=this.value==='bibtex'?bibtex:yaml;};var input=document.createElement('input');input.type='text';input.style.width='100%';input.style.marginBottom='10px';input.style.padding='8px';input.style.backgroundColor='#ffffff';input.style.color='#000000';input.style.border='1px solid #cccccc';input.value=`${citeKey}.bib`;modal.appendChild(input);var buttonContainer=document.createElement('div');buttonContainer.style.display='flex';buttonContainer.style.gap='10px';buttonContainer.style.justifyContent='flex-end';var downloadButton=document.createElement('button');downloadButton.textContent='Download';downloadButton.style.padding='8px 16px';downloadButton.style.backgroundColor='#ffffff';downloadButton.style.color='#000000';downloadButton.style.border='1px solid #cccccc';downloadButton.style.cursor='pointer';downloadButton.onmouseover=function(){this.style.opacity='0.8'};downloadButton.onmouseout=function(){this.style.opacity='1'};downloadButton.onclick=function(){var blob=new Blob([textarea.value],{type:'text/plain;charset=utf-8'});var link=document.createElement('a');link.href=URL.createObjectURL(blob);link.download=input.value||`${citeKey}.${formatToggle.value==='bibtex'?'bib':'yaml'}`;document.body.appendChild(link);link.click();document.body.removeChild(link);document.body.removeChild(modal);document.body.removeChild(overlay);};buttonContainer.appendChild(downloadButton);var cancelButton=document.createElement('button');cancelButton.textContent='Cancel';cancelButton.style.padding='8px 16px';cancelButton.style.backgroundColor='#ffffff';cancelButton.style.color='#000000';cancelButton.style.border='1px solid #cccccc';cancelButton.style.cursor='pointer';cancelButton.onmouseover=function(){this.style.opacity='0.8'};cancelButton.onmouseout=function(){this.style.opacity='1'};cancelButton.onclick=function(){document.body.removeChild(modal);document.body.removeChild(overlay);};buttonContainer.appendChild(cancelButton);modal.appendChild(buttonContainer);document.body.appendChild(modal);})();